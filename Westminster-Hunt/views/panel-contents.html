<h2>Categories</h2>
<ul data-role="listview" id="mission-categories" class="ui-nodisc-icon">
  <li><a href="#" view="Campuses" class="ui-alt-icon">Campuses</a></li>
  <li><a href="#" view="Essentials" class="ui-alt-icon">Essentials</a></li>
  <li><a href="#" view="People" class="ui-alt-icon">People</a></li>
  <li><a href="#" view="Study" class="ui-alt-icon">Study</a></li>
</ul>
<table id="nav-buttons">
  <tr>
    <td view="Newsletter">Newsletter</td>
    <td view="Guide">Guide</td>
  </tr>
  <tr>
    <td view="Map">Map of Campuses</td>
    <td view="Favourites">Favourites</td>
  </tr>
</table>

<script>
  // function to dynamically load new pages using AJAX
  loadCategory = function() {
    categoryName = $(this).attr("view");
    console.log("c " + categoryName);

    // make element active
    $('.active-btn').addClass('ui-alt-icon').removeClass('active-btn');
    $(this).addClass('active-btn').removeClass('ui-alt-icon');

    // loadOff view listeners

    // load ajax
    retrievedCategory = null;
    if (localStorage.getItem('categoryName') == null)
    {
      $.ajax({
        url: "model/" + categoryName + ".json"
      })
      .done(function( data ) {
        // save JSON as string in localStorage
        localStorage.setItem('categoryName', JSON.stringify(data));
        retrievedCategory = data;
      });
    }
    else {
      retrievedCategory = JSON.parse(localStorage.getItem('categoryName'));
    }

    console.log('retrievedCategory: ', retrievedCategory);

    // make it JSON

    // dynamically create content
  };
  loadView = function() {
    viewName = $(this).attr("view");
    console.log("v " + viewName);

    // make element active
    $('.active-btn').addClass('ui-alt-icon').removeClass('active-btn');
    $(this).addClass('active-btn').removeClass('ui-alt-icon');

    // loadOff view listeners

    // load ajax;
    $.ajax({
      url: "views/" + viewName + ".html"
    })
    .done(function( data ) {
      changePageTitle(viewName);
      $('#content-frame').html(data);
    });
  };

  // assigning listeners
  $('#mission-categories li a').click(loadCategory);
  $("#nav-buttons tr td").click(loadView);


  // loadOff to be run when the view is changed, to shut down listeners
  loadOffPanned = function() {
    $('#mission-categories li a').unbind();
  };

  changePageTitle = function(newName) {
    $('#title').html(newName);
  }
</script>
